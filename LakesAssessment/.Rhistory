setwd("/home/mkozlak/Documents/Projects/GitHub/Lakes/LakesAssessment")
library(ggplot2)
library(grid)
library(gridExtra)
library(rgdal)
library(sp)
library(sf)
library(png)
lakes<-read.csv("data/LakeData17.csv",header=TRUE)
lakespoly<-read_sf("data/nla_lakes17.geojson")
##Calculate Trophic Score for Each Parameter (TP, TN, Chlor a, Transparency)
lakes$TPCAT<-ifelse(lakes$Phosphorus<=0.010,1,
ifelse(lakes$Phosphorus>0.010 & lakes$Phosphorus<=0.015,2,
ifelse(lakes$Phosphorus>0.015 & lakes$Phosphorus<=0.025,3,
ifelse(lakes$Phosphorus>0.025 & lakes$Phosphorus<=0.030,4,
ifelse(lakes$Phosphorus>0.030 & lakes$Phosphorus<=0.050,5,
ifelse(lakes$Phosphorus > 0.050,6,NA))))))
lakes$NCAT<-ifelse(lakes$Nitrogen<=0.2,1,
ifelse(lakes$Nitrogen>0.2 & lakes$Nitrogen<=0.3,2,
ifelse(lakes$Nitrogen>0.3 & lakes$Nitrogen<=0.5,3,
ifelse(lakes$Nitrogen>0.5 & lakes$Nitrogen<=0.6,4,
ifelse(lakes$Nitrogen>0.6 & lakes$Nitrogen<=1,5,
ifelse(lakes$Nitrogen > 1,6,NA))))))
lakes$CCAT<-ifelse(lakes$Chlorophyll.a<=2,1,
ifelse(lakes$Chlorophyll.a>2 & lakes$Chlorophyll.a<=5,2,
ifelse(lakes$Chlorophyll.a>5 & lakes$Chlorophyll.a<=10,3,
ifelse(lakes$Chlorophyll.a>10 & lakes$Chlorophyll.a<=15,4,
ifelse(lakes$Chlorophyll.a>15 & lakes$Chlorophyll.a<=30,5,
ifelse(lakes$Chlorophyll.a > 30,6,NA))))))
lakes$SCAT<-ifelse(lakes$Secchi>=6,1,
ifelse(lakes$Secchi<6 & lakes$Secchi>=4,2,
ifelse(lakes$Secchi<4 & lakes$Secchi>=3,3,
ifelse(lakes$Secchi<3 & lakes$Secchi>=2,4,
ifelse(lakes$Secchi<2 & lakes$Secchi>=1,5,
ifelse(lakes$Secchi < 1,6,NA))))))
#Average the Trophic Scores and Assign a Trophic Category
lakes$TAvg<-rowMeans(subset(lakes,select=c(TPCAT,NCAT,CCAT,SCAT)),na.rm=TRUE)
lakes$Trophic<- ifelse(lakes$TAvg<=2,"Oligotrophic",
ifelse(lakes$TAvg>2 & lakes$TAvg<=3,"Early Mesotrophic",
ifelse(lakes$TAvg>3 & lakes$TAvg<=4,"Mesotrophic",
ifelse(lakes$TAvg>4 & lakes$TAvg<=5,"Late Mesotrophic",
ifelse(lakes$TAvg>5 & lakes$TAvg<6,"Eutrophic",
ifelse(lakes$TAvg == 6,"Highly Eutrophic",NA))))))
i<-4
l<- lakes[i,]
##Parse out the lake data that you are interested in
lakemapdata<-lakespoly[lakespoly$STA_SEQ==l$STA_SEQ,]
lakemap<-ggplot(lakemapdata)+
geom_sf(colour="deepskyblue1",fill="midnightblue")+
theme(panel.background=element_rect(fill="grey12",color="grey50"),
panel.grid=element_blank(),
axis.text=element_text(size=6))
lakemap
library(tmap)
tm_shape(lakemapdata)
tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
tmap_mode("view")
tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
tm_basemap("Stamen.Watercolor")+tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
map1<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
map2<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
tmap_arrange(map1,map2)
map1
map2<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
map1<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
tmap_arrange(map1,map2)
map1
map1<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
map1
tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
stop()
tmap_mode("plot")
tm_shape(lakemapdata)+tm_polygons("STA_SEQ")+tm_tiles("Stamen.TonerLabels")
map1<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
map1
map2<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
tm_arrange(map1,map2)
tmap_arrange(map1,map2)
map2<-tm_shape(lakemapdata)+tm_polygons(col="deepskyblue1")
map2
tmap_arrange(map1,map2)
map3<-tmap_arrange(map1,map2)
map3
tmap_save(map3)
lakes
i<-1
l<- lakes[i,]
##Parse out the lake data that you are interested in
lakemapdata<-lakespoly[lakespoly$STA_SEQ==l$STA_SEQ,]
map1<-tm_shape(lakemapdata)+tm_polygons("STA_SEQ")
map2<-tm_shape(lakemapdata)+tm_polygons(col="deepskyblue1")
map3
map3<-tmap_arrange(map1,map2)
map3
tmap_save(map3)
cttownspoly<-read_sf("data/CTTowns.geojson")
tm_shape(cttownspoly)+tm_polygons(col="gray")
cttownspoly<-read_sf("data/CTTowns.geojson")
tm_shape(cttownspoly)+tm_polygons(col="gray")
tm_shape(cttownspoly)+tm_polygons(col="gray")+tm_shape(lakemapdata)+tm_polygons(col="blue")
lakeslatlong<-lakes[lakes$XLong,lakes$YLat,lakes$STA_SEQ]
lakeslatlong<-lakes[lakes$XLong,lakes$YLat,lakes$STA_SEQ,]
lakeslatlong<-lakes[c(lakes$XLong,lakes$YLat,lakes$STA_SEQ),]
lakeslatlong<-lakes[,c(lakes$XLong,lakes$YLat,lakes$STA_SEQ)]
names(lakes)
lakeslatlong<-lakes[,3:5]
lakespts<-read_sf("data/nla_lakes17.geojson")
tm_shape(cttownspoly)+tm_polygons(col="gray")+tm_shape(lakepts)+tm_symbols(col="red")
tm_shape(cttownspoly)+tm_polygons(col="gray")+tm_shape(lakespts)+tm_symbols(col="red")
i<1
i<-1
l<- lakes[i,]
##Parse out the lake data that you are interested in
lakemappoly<-lakespoly[lakespoly$STA_SEQ==l$STA_SEQ,]
lakemappt<-lakespts[lakespts$STA_SEQ==l$STA_SEQ]
l<- lakes[i,]
##Parse out the lake data that you are interested in
lakemappoly<-lakespoly[lakespoly$STA_SEQ==l$STA_SEQ,]
lakemappt<-lakespts[lakespts$STA_SEQ==l$STA_SEQ,]
smap<-  tm_shape(cttownspoly)+
tm_polygons(col="gray")+
tm_shape(lakemappt)+
tm_symbols(col="red")
smap
tm_shapre(lakemappoly)+
tm_polygons(col="deepskyblue1")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1")+
tm_borders("white",lwd=0.5)+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1")+
tm_shape(lakemappoly)+
tm_borders("white",lwd=0.5)+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1")+
tm_shape(lakemappoly)+
tm_borders("white",lwd=1)+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1")+
tm_shape(lakemappoly)+
tm_borders("white",lwd=2)+
tm_layout(bg.color="midnightblue")
tmap_arrange(smap,lmap)
smap<-  tm_shape(cttownspoly)+
tm_polygons(col="gray")+
tm_shape(lakemappt)+
tm_symbols(col="red")
lmap<-  tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1")+
tm_shape(lakemappoly)+
tm_borders("white",lwd=2)+
tm_layout(bg.color="midnightblue")
tmap_arrange(smap,lmap)
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white")+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white",lwd=2)+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white",lwd=2,border.alpha=0.7)+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white",lwd=3,border.alpha=0.9)+
tm_layout(bg.color="midnightblue")
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white",lwd=3,border.alpha=0.7)+
tm_layout(bg.color="midnightblue")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="red")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="red")
tm_layout(bg.color="midnightblue")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="red")+
tm_layout(bg.color="midnightblue")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="midnightblue")+
tm_layout(bg.color="midnightblue")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="midnightblue")+
tm_layout(bg.color="blue")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="blue")+
tm_layout(bg.color="midnightblue")
tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="black")+
tm_layout(bg.color="midnightblue")
smap<-  tm_shape(cttownspoly)+
tm_polygons(col="gray",border.col="white",lwd=2)+
tm_shape(lakemappt)+
tm_symbols(col="black")+
tm_layout(bg.color="midnightblue")
lmap<-  tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white",lwd=3,border.alpha=0.7)+
tm_layout(bg.color="midnightblue")
tmap_arrange(smap,lmap)
wmap<-tmap_arrange(smap,lmap)
tmap_save(wmap,width=800,height=600,dpi=72)
tm_shape(lakemappoly)+
tm_polygons(col="deepskyblue1",border.col="white",lwd=3,border.alpha=0.7)+
tm_shape(lakemappt)+
tm_symbols(col="black")+
tm_layout(bg.color="midnightblue")
tmap_save(wmap,paste(i,"lake.png"),width=800,height=600,dpi=72)
tmap_save(wmap,paste0(i,"lake.png"),width=800,height=600,dpi=72)
gradient<-data.frame(x=c(0,1,2,3,4,5,6,7),
y=c(1,1,1,1,1,1,1,1),
z=c(1,1,2,3,4,5,6,6))
p1<-  ggplot()+
xlim(0,7)+
ylim(0.5,1.5)+
scale_x_continuous(breaks=c(1,3,5,6),
label=c("Oligotrophic","Mesotrophic",
"Eutrophic","Highly Eutrophic"),position="top")+
geom_raster(data=gradient,aes(x,y,fill=z),interpolate=TRUE)+
scale_fill_gradientn(colours = c("blue","cyan","chartreuse"))+
geom_point(data=l,aes(TAvg,1),shape=17,size=4)+
theme(panel.background = element_rect(fill = "white", colour = "white"),
axis.title=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),legend.position = "none",
axis.text.x=element_text(face = "bold", color = "black", size = 9))
p2<-  ggplot()+
xlim(0,7)+
ylim(0.5,1.5)+
# scale_x_continuous(breaks=c(1,3,5,6),
#                label=c("Oligotrophic","Mesotrophic",
#                        "Eutrophic","Highly Eutrophic"))+
scale_x_continuous(breaks=c(1,3,5,6),
label=c("","",
"",""),position="top")+
geom_raster(data=gradient,aes(x,y,fill=z),interpolate=TRUE)+
scale_fill_gradientn(colours = c("blue","cyan","chartreuse"))+
geom_point(data=l,aes(TPCAT,1),shape=17,size=4)+
theme(panel.background = element_rect(fill = "white", colour = "white"),
axis.title=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),axis.ticks.x=element_blank(),legend.position = "none")
p3<-  ggplot()+
xlim(0,7)+
ylim(0.5,1.5)+
# scale_x_continuous(breaks=c(1,3,5,6),
#                label=c("Oligotrophic","Mesotrophic",
#                        "Eutrophic","Highly Eutrophic"))+
scale_x_continuous(breaks=c(1,3,5,6),
label=c("","",
"",""),position="top")+
geom_raster(data=gradient,aes(x,y,fill=z),interpolate=TRUE)+
scale_fill_gradientn(colours = c("blue","cyan","chartreuse"))+
geom_point(data=l,aes(NCAT,1),shape=17,size=4)+
theme(panel.background = element_rect(fill = "white", colour = "white"),
axis.title=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),axis.ticks.x=element_blank(),legend.position = "none")
p4<-  ggplot()+
xlim(0,7)+
ylim(0.5,1.5)+
# scale_x_continuous(breaks=c(1,3,5,6),
#                label=c("Oligotrophic","Mesotrophic",
#                        "Eutrophic","Highly Eutrophic"))+
scale_x_continuous(breaks=c(1,3,5,6),
label=c("","",
"",""),position="top")+
geom_raster(data=gradient,aes(x,y,fill=z),interpolate=TRUE)+
scale_fill_gradientn(colours = c("blue","cyan","chartreuse"))+
geom_point(data=l,aes(CCAT,1),shape=17,size=4)+
theme(panel.background = element_rect(fill = "white", colour = "white"),
axis.title=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),axis.ticks.x=element_blank(),legend.position = "none")
p5<-  ggplot()+
xlim(0,7)+
ylim(0.5,1.5)+
# scale_x_continuous(breaks=c(1,3,5,6),
#                label=c("Oligotrophic","Mesotrophic",
#                        "Eutrophic","Highly Eutrophic"))+
scale_x_continuous(breaks=c(1,3,5,6),
label=c("","",
"",""),position="top")+
geom_raster(data=gradient,aes(x,y,fill=z),interpolate=TRUE)+
scale_fill_gradientn(colours = c("blue","cyan","chartreuse"))+
geom_point(data=l,aes(SCAT,1),shape=17,size=4)+
theme(panel.background = element_rect(fill = "white", colour = "white"),
axis.title=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),axis.ticks.x=element_blank(),legend.position = "none")
tcat<-textGrob(paste("Trophic Category:",l$Trophic),
gp=gpar(fontsize=14,fontface="bold.italic", col="black"))#21
ptjust<-"left"
ptposx<-0.2
ptposy<-0.5
p1t<-textGrob("Trophic State Index",just=ptjust,ptposx,ptposy)#11-12
p2t<-textGrob("Total Phosphorus",just=ptjust,ptposx,ptposy)#13-14
p3t<-textGrob("Total Nitrogen",just=ptjust,ptposx,ptposy)#15-16
p4t<-textGrob("Chlorophyll-a",just=ptjust,ptposx,ptposy)#17-18
p5t<-textGrob("Transparency",just=ptjust,ptposx,ptposy)#19-20
lay<-rbind(c(1,NA,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
ggsave(paste0(i,".png"),laketest,width=11,height=8,units="in",dpi=72)
ggsave(paste0(i,".png"),laketest,width=10,height=6,units="in",dpi=72)
ggsave(paste0(i,".png"),laketest,width=10,height=5,units="in",dpi=72)
tcat<-textGrob(paste("Trophic Category:",l$Trophic),
gp=gpar(fontsize=20,fontface="bold.italic", col="black"))#21
ptjust<-"left"
ptposx<-0.2
ptposy<-0.5
p1t<-textGrob("Trophic State Index",just=ptjust,ptposx,ptposy)#11-12
p2t<-textGrob("Total Phosphorus",just=ptjust,ptposx,ptposy)#13-14
p3t<-textGrob("Total Nitrogen",just=ptjust,ptposx,ptposy)#15-16
p4t<-textGrob("Chlorophyll-a",just=ptjust,ptposx,ptposy)#17-18
p5t<-textGrob("Transparency",just=ptjust,ptposx,ptposy)#19-20
lay<-rbind(c(1,NA,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
ggsave(paste0(i,".png"),laketest,width=10,height=5,units="in",dpi=72)
lay<-rbind(c(1,1,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
lay<-rbind(c(1,1,NA),
c(NA,NA,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
lay<-rbind(c(1,1,NA),
c(1,1,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
tcat<-textGrob(paste("Trophic Category:",l$Trophic),
gp=gpar(fontsize=20,fontface="bold.italic", col="black"))#21
ptjust<-"left"
ptposx<-0.2
ptposy<-0.5
p1t<-textGrob("Trophic State Index",just=ptjust,ptposx,ptposy)#11-12
p2t<-textGrob("Total Phosphorus",just=ptjust,ptposx,ptposy)#13-14
p3t<-textGrob("Total Nitrogen",just=ptjust,ptposx,ptposy)#15-16
p4t<-textGrob("Chlorophyll-a",just=ptjust,ptposx,ptposy)#17-18
p5t<-textGrob("Transparency",just=ptjust,ptposx,ptposy)#19-20
lay<-rbind(c(1,1,NA),
c(1,1,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
tcat<-textGrob(paste("Trophic Category:",l$Trophic),
gp=gpar(fontsize=20,fontface="bold", col="black"))#21
ptjust<-"left"
ptposx<-0.2
ptposy<-0.5
p1t<-textGrob("Trophic State Index",just=ptjust,ptposx,ptposy)#11-12
p2t<-textGrob("Total Phosphorus",just=ptjust,ptposx,ptposy)#13-14
p3t<-textGrob("Total Nitrogen",just=ptjust,ptposx,ptposy)#15-16
p4t<-textGrob("Chlorophyll-a",just=ptjust,ptposx,ptposy)#17-18
p5t<-textGrob("Transparency",just=ptjust,ptposx,ptposy)#19-20
lay<-rbind(c(1,1,NA),
c(1,1,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
ggsave(paste0(i,".png"),laketest,width=10,height=5,units="in",dpi=72)
ggsave(paste0(i,".png"),laketest,width=15,height=5,units="in",dpi=72)
tmap_save(wmap,paste0(i,"lake.png"),width=600,height=400,dpi=72)
lay<-rbind(c(1,NA,NA),
c(NA,NA,NA),
c(2,NA,NA),
c(3,3,3),
c(4,NA,NA),
c(5,5,5),
c(6,NA,NA),
c(7,7,7),
c(8,NA,NA),
c(9,9,9),
c(10,NA,NA),
c(11,11,11))
laketest<-grid.arrange(tcat,
p1t,p1,p2t,p2,p3t,p3,p4t,p4,p5t,p5,
ncol=1,layout_matrix=lay,
heights=unit(c(0.25,0.25,0.25,0.5,0.25,0.5,0.25,
0.5,0.25,0.5,0.25,0.5),
c("in","in","in","in","in","in","in","in",
"in","in","in","in")))
laketest
ggsave(paste0(i,".png"),laketest,width=15,height=5,units="in",dpi=72)
